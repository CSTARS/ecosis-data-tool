<dom-module id="esis-file-manager">
    <style>
        .page-header {
            border-bottom: 1px solid #ebebeb;
        }
    </style>

    <template>
        <h4 class="page-header" style="margin-top:0;padding-top:0">Add</h4>
        <input style="display:none;" id="fileDialog" type="file" on-change="onSelect" />
        <a class="btn btn-default" on-click="chooseFile">Select File</a>

        <h4 class="page-header">Manage</h4>
        <div id="files"></div>
    </template>
</dom-module>

<script src="./scripts/elements/FileManager.js"></script>
<script>
    Polymer({
        is: 'esis-file-manager',

        mixins : [FileManager],

        configure : function() {
            return {
                currentFile : {},
                files : []
            }
        },

        chooseFile : function() {
            this.$.fileDialog.click();
        },

        onSelect : function(e) {
            this.select(this.$.fileDialog.value);
        },

        redrawFiles : function() {
            for( var i = 0; i < this.files.length; i++ ) {
                var panel = '<div><h5>'+this.files[i].name+'</h5><div><ul>';

                for( var j = 0; j < this.files[i].tables.length; j++ ) {
                    panel += '<li>Sheet '+j+': '+this.files[i].formats.type+' '+this.files[i].formats.orientation;
                }
                panel += '</ul></div>'
            }
            panel += '</div>'
            this.$.files.innerHTML = panel;
        }


    });
</script>